import "dart:typed_data" as NB;import "dart:math" as QB;import "dart:html" as UB;var RB=2;var HB;var t;var IB;var KB;var LB=0.0;final  q=new k(IB*0.5,KB*0.5,100.0);final  u=new l.mB();final  GB=new QB.Random(100); get VB=>IB; get WB=>KB; get XB{return '#${GB.nextInt(255).toRadixString(16)}${GB.nextInt(255).toRadixString(16)}${GB.nextInt(255).toRadixString(16)}';} main(){HB=UB.query("#container");t=HB.context2D;IB=(HB.parent as UB.Element).clientWidth;KB=(HB.parent as UB.Element).clientHeight;HB.width=IB;var h;var i;for(int j=0;j<5000; ++j){h=new v(GB.nextDouble()*q.x,GB.nextDouble()*q.y,GB.nextDouble()*q.z,XB);if(i!=null)i.next=h;i=h;if(v.OB==null)v.OB=h;}t.fillStyle="#FFFFFF";t.setTransform(1,0,0,1,0,0);UB.window.requestAnimationFrame(SB);} SB( nB){YB();u.TB();u.translate(q.x*0.5,q.y*0.5,q.z*0.5);u.dB(LB);u.eB(LB);u.fB(LB);u.translate(-q.x*0.5,-q.y*0.5,-q.z*0.5);LB=0.005;var h=v.OB;while (h!=null){h.cB();h=h.next;}UB.window.requestAnimationFrame(SB);} YB(){t.save();t.transform(1,0,0,1,0,0);t.clearRect(0,0,VB,WB);t.restore();}class v{static var OB;static final  PB=new o(0.0,0.0);var next;var oB;var pB;v( i, h, j,this.pB){oB=new k(i,h,j);} cB(){ZB(oB,PB);t.fillStyle=pB;t.fillRect(PB.x.toInt(),PB.y.toInt(),RB,RB);}static  ZB( j, i){var h=u.gB(j);h.aB(u);i.x=h.x+(IB-q.x)*0.5;i.y=h.y+(KB-q.y)*0.5;}}class hB{const hB();}class iB{final  name;const iB(this.name);}class jB{const jB();}class o{final  g=new NB.Float32List(2);o( i, h){JB(i,h);} JB( i, h){g[0]=i;g[1]=h;return this;} toString()=>'[${g[0]},${g[1]}]'; operator-()=>new o(-g[0],-g[1]); operator-( h)=>new o(g[0]-h.g[0],g[1]-h.g[1]); operator+( h)=>new o(g[0]+h.g[0],g[1]+h.g[1]); operator/( i){var h=1.0/i;return new o(g[0]*h,g[1]*h);} operator*( i){var h=i;return new o(g[0]*h,g[1]*h);} operator[]( h)=>g[h]; operator[]=( i, h){g[i]=h;} get length{var h;h=(g[0]*g[0]);h+= (g[1]*g[1]);return QB.sqrt(h);} add( h){g[0]=g[0]+h.g[0];g[1]=g[1]+h.g[1];return this;}set x( h)=>g[0]=h;set y( h)=>g[1]=h; get x=>g[0]; get y=>g[1];}class k{final  g=new NB.Float32List(3);k( j, i, h){JB(j,i,h);}k.lB(); JB( j, i, h){g[0]=j;g[1]=i;g[2]=h;return this;} toString()=>'[${g[0]},${g[1]},${g[2]}]'; operator-()=>new k(-g[0],-g[1],-g[2]); operator-( h)=>new k(g[0]-h.g[0],g[1]-h.g[1],g[2]-h.g[2]); operator+( h)=>new k(g[0]+h.g[0],g[1]+h.g[1],g[2]+h.g[2]); operator/( i){var h=1.0/i;return new k(g[0]*h,g[1]*h,g[2]*h);} operator*( i){var h=i;return new k(g[0]*h,g[1]*h,g[2]*h);} operator[]( h)=>g[h]; operator[]=( i, h){g[i]=h;} get length{var h;h=(g[0]*g[0]);h+= (g[1]*g[1]);h+= (g[2]*g[2]);return QB.sqrt(h);} aB( h){var qB=g[0];var rB=g[1];var sB=g[2];var i=1.0/(h.g[3]*qB+h.g[7]*rB+h.g[11]*sB+h.g[15]);g[0]=(h.g[0]*qB+h.g[4]*rB+h.g[8]*sB+h.g[12])*i;g[1]=(h.g[1]*qB+h.g[5]*rB+h.g[9]*sB+h.g[13])*i;g[2]=(h.g[2]*qB+h.g[6]*rB+h.g[10]*sB+h.g[14])*i;return this;} add( h){g[0]=g[0]+h.g[0];g[1]=g[1]+h.g[1];g[2]=g[2]+h.g[2];return this;}set x( h)=>g[0]=h;set y( h)=>g[1]=h;set z( h)=>g[2]=h; get x=>g[0]; get y=>g[1]; get z=>g[2];}class m{final  g=new NB.Float32List(4);m( n, i, h, j){JB(n,i,h,j);}m.lB(); JB( n, i, h, j){g[3]=j;g[2]=h;g[1]=i;g[0]=n;return this;} toString()=>'${g[0]},${g[1]},' '${g[2]},${g[3]}'; operator-()=>new m(-g[0],-g[1],-g[2],-g[3]); operator-( h)=>new m(g[0]-h.g[0],g[1]-h.g[1],g[2]-h.g[2],g[3]-h.g[3]); operator+( h)=>new m(g[0]+h.g[0],g[1]+h.g[1],g[2]+h.g[2],g[3]+h.g[3]); operator/( i){var h=1.0/i;return new m(g[0]*h,g[1]*h,g[2]*h,g[3]*h);} operator*( i){var h=i;return new m(g[0]*h,g[1]*h,g[2]*h,g[3]*h);} operator[]( h)=>g[h]; operator[]=( i, h){g[i]=h;} get length{var h;h=(g[0]*g[0]);h+= (g[1]*g[1]);h+= (g[2]*g[2]);h+= (g[3]*g[3]);return QB.sqrt(h);} add( h){g[0]=g[0]+h.g[0];g[1]=g[1]+h.g[1];g[2]=g[2]+h.g[2];g[3]=g[3]+h.g[3];return this;}set x( h)=>g[0]=h;set y( h)=>g[1]=h;set z( h)=>g[2]=h; get x=>g[0]; get y=>g[1]; get z=>g[2]; get w=>g[3];}class l{final  g=new NB.Float32List(16); index( h, i)=>(i*4)+h;l.lB();l.mB(){TB();} toString(){var h='';h='${h}[0] ${MB(0)}\n';h='${h}[1] ${MB(1)}\n';h='${h}[2] ${MB(2)}\n';h='${h}[3] ${MB(3)}\n';return h;} get bB=>4; operator[]( h)=>g[h]; operator[]=( i, h){g[i]=h;} MB( i){var h=new m.lB();h.g[0]=g[index(i,0)];h.g[1]=g[index(i,1)];h.g[2]=g[index(i,2)];h.g[3]=g[index(i,3)];return h;} tB( i){var h=new l.lB();h.g[15]=g[15]*i;h.g[14]=g[14]*i;h.g[13]=g[13]*i;h.g[12]=g[12]*i;h.g[11]=g[11]*i;h.g[10]=g[10]*i;h.g[9]=g[9]*i;h.g[8]=g[8]*i;h.g[7]=g[7]*i;h.g[6]=g[6]*i;h.g[5]=g[5]*i;h.g[4]=g[4]*i;h.g[3]=g[3]*i;h.g[2]=g[2]*i;h.g[1]=g[1]*i;h.g[0]=g[0]*i;return h;} uB( h){var i=new l.lB();i.g[0]=(g[0]*h.g[0])+(g[4]*h.g[1])+(g[8]*h.g[2])+(g[12]*h.g[3]);i.g[4]=(g[0]*h.g[4])+(g[4]*h.g[5])+(g[8]*h.g[6])+(g[12]*h.g[7]);i.g[8]=(g[0]*h.g[8])+(g[4]*h.g[9])+(g[8]*h.g[10])+(g[12]*h.g[11]);i.g[12]=(g[0]*h.g[12])+(g[4]*h.g[13])+(g[8]*h.g[14])+(g[12]*h.g[15]);i.g[1]=(g[1]*h.g[0])+(g[5]*h.g[1])+(g[9]*h.g[2])+(g[13]*h.g[3]);i.g[5]=(g[1]*h.g[4])+(g[5]*h.g[5])+(g[9]*h.g[6])+(g[13]*h.g[7]);i.g[9]=(g[1]*h.g[8])+(g[5]*h.g[9])+(g[9]*h.g[10])+(g[13]*h.g[11]);i.g[13]=(g[1]*h.g[12])+(g[5]*h.g[13])+(g[9]*h.g[14])+(g[13]*h.g[15]);i.g[2]=(g[2]*h.g[0])+(g[6]*h.g[1])+(g[10]*h.g[2])+(g[14]*h.g[3]);i.g[6]=(g[2]*h.g[4])+(g[6]*h.g[5])+(g[10]*h.g[6])+(g[14]*h.g[7]);i.g[10]=(g[2]*h.g[8])+(g[6]*h.g[9])+(g[10]*h.g[10])+(g[14]*h.g[11]);i.g[14]=(g[2]*h.g[12])+(g[6]*h.g[13])+(g[10]*h.g[14])+(g[14]*h.g[15]);i.g[3]=(g[3]*h.g[0])+(g[7]*h.g[1])+(g[11]*h.g[2])+(g[15]*h.g[3]);i.g[7]=(g[3]*h.g[4])+(g[7]*h.g[5])+(g[11]*h.g[6])+(g[15]*h.g[7]);i.g[11]=(g[3]*h.g[8])+(g[7]*h.g[9])+(g[11]*h.g[10])+(g[15]*h.g[11]);i.g[15]=(g[3]*h.g[12])+(g[7]*h.g[13])+(g[11]*h.g[14])+(g[15]*h.g[15]);return i;} vB( h){var i=new m.lB();i.g[3]=(g[3]*h.g[0])+(g[7]*h.g[1])+(g[11]*h.g[2])+(g[15]*h.g[3]);i.g[2]=(g[2]*h.g[0])+(g[6]*h.g[1])+(g[10]*h.g[2])+(g[14]*h.g[3]);i.g[1]=(g[1]*h.g[0])+(g[5]*h.g[1])+(g[9]*h.g[2])+(g[13]*h.g[3]);i.g[0]=(g[0]*h.g[0])+(g[4]*h.g[1])+(g[8]*h.g[2])+(g[12]*h.g[3]);return i;} wB( h){var i=new k.lB();i.g[0]=(g[0]*h.g[0])+(g[4]*h.g[1])+(g[8]*h.g[2])+g[12];i.g[1]=(g[1]*h.g[0])+(g[5]*h.g[1])+(g[9]*h.g[2])+g[13];i.g[2]=(g[2]*h.g[0])+(g[6]*h.g[1])+(g[10]*h.g[2])+g[14];return i;} operator*( h){if(h is double){return tB(h);}if(h is m){return vB(h);}if(h is k){return wB(h);}if(4==h.bB){return uB(h);}throw new ArgumentError(h);} operator+( i){var h=new l.lB();h.g[0]=g[0]+i.g[0];h.g[1]=g[1]+i.g[1];h.g[2]=g[2]+i.g[2];h.g[3]=g[3]+i.g[3];h.g[4]=g[4]+i.g[4];h.g[5]=g[5]+i.g[5];h.g[6]=g[6]+i.g[6];h.g[7]=g[7]+i.g[7];h.g[8]=g[8]+i.g[8];h.g[9]=g[9]+i.g[9];h.g[10]=g[10]+i.g[10];h.g[11]=g[11]+i.g[11];h.g[12]=g[12]+i.g[12];h.g[13]=g[13]+i.g[13];h.g[14]=g[14]+i.g[14];h.g[15]=g[15]+i.g[15];return h;} operator-( i){var h=new l.lB();h.g[0]=g[0]-i.g[0];h.g[1]=g[1]-i.g[1];h.g[2]=g[2]-i.g[2];h.g[3]=g[3]-i.g[3];h.g[4]=g[4]-i.g[4];h.g[5]=g[5]-i.g[5];h.g[6]=g[6]-i.g[6];h.g[7]=g[7]-i.g[7];h.g[8]=g[8]-i.g[8];h.g[9]=g[9]-i.g[9];h.g[10]=g[10]-i.g[10];h.g[11]=g[11]-i.g[11];h.g[12]=g[12]-i.g[12];h.g[13]=g[13]-i.g[13];h.g[14]=g[14]-i.g[14];h.g[15]=g[15]-i.g[15];return h;} translate( h,[ AB=0.0, BB=0.0]){var i;var n;var j;var s=h is m?h.w:1.0;if(h is k||h is m){i=h.x;n=h.y;j=h.z;}else{i=h;n=AB;j=BB;}var CB=g[0]*i+g[4]*n+g[8]*j+g[12]*s;var DB=g[1]*i+g[5]*n+g[9]*j+g[13]*s;var EB=g[2]*i+g[6]*n+g[10]*j+g[14]*s;var FB=g[3]*i+g[7]*n+g[11]*j+g[15]*s;g[12]=CB;g[13]=DB;g[14]=EB;g[15]=FB;return this;} dB( j){var i=QB.cos(j);var h=QB.sin(j);var CB=g[4]*i+g[8]*h;var AB=g[5]*i+g[9]*h;var n=g[6]*i+g[10]*h;var EB=g[7]*i+g[11]*h;var DB=g[4]*-h+g[8]*i;var BB=g[5]*-h+g[9]*i;var s=g[6]*-h+g[10]*i;var FB=g[7]*-h+g[11]*i;g[4]=CB;g[5]=AB;g[6]=n;g[7]=EB;g[8]=DB;g[9]=BB;g[10]=s;g[11]=FB;return this;} eB( j){var i=QB.cos(j);var h=QB.sin(j);var CB=g[0]*i+g[8]*h;var AB=g[1]*i+g[9]*h;var n=g[2]*i+g[10]*h;var EB=g[3]*i+g[11]*h;var DB=g[0]*-h+g[8]*i;var BB=g[1]*-h+g[9]*i;var s=g[2]*-h+g[10]*i;var FB=g[3]*-h+g[11]*i;g[0]=CB;g[1]=AB;g[2]=n;g[3]=EB;g[8]=DB;g[9]=BB;g[10]=s;g[11]=FB;return this;} fB( j){var i=QB.cos(j);var h=QB.sin(j);var CB=g[0]*i+g[4]*h;var AB=g[1]*i+g[5]*h;var n=g[2]*i+g[6]*h;var EB=g[3]*i+g[7]*h;var DB=g[0]*-h+g[4]*i;var BB=g[1]*-h+g[5]*i;var s=g[2]*-h+g[6]*i;var FB=g[3]*-h+g[7]*i;g[0]=CB;g[1]=AB;g[2]=n;g[3]=EB;g[4]=DB;g[5]=BB;g[6]=s;g[7]=FB;return this;} operator-(){var h=new l.lB();h[0]=-g[0];h[1]=-g[1];h[2]=-g[2];h[3]=-g[3];return h;} TB(){g[0]=1.0;g[1]=0.0;g[2]=0.0;g[3]=0.0;g[4]=0.0;g[5]=1.0;g[6]=0.0;g[7]=0.0;g[8]=0.0;g[9]=0.0;g[10]=1.0;g[11]=0.0;g[12]=0.0;g[13]=0.0;g[14]=0.0;g[15]=1.0;return this;} add( h){g[0]=g[0]+h.g[0];g[1]=g[1]+h.g[1];g[2]=g[2]+h.g[2];g[3]=g[3]+h.g[3];g[4]=g[4]+h.g[4];g[5]=g[5]+h.g[5];g[6]=g[6]+h.g[6];g[7]=g[7]+h.g[7];g[8]=g[8]+h.g[8];g[9]=g[9]+h.g[9];g[10]=g[10]+h.g[10];g[11]=g[11]+h.g[11];g[12]=g[12]+h.g[12];g[13]=g[13]+h.g[13];g[14]=g[14]+h.g[14];g[15]=g[15]+h.g[15];return this;} gB( h){var n=(g[0]*h.g[0])+(g[4]*h.g[1])+(g[8]*h.g[2])+g[12];var j=(g[1]*h.g[0])+(g[5]*h.g[1])+(g[9]*h.g[2])+g[13];var i=(g[2]*h.g[0])+(g[6]*h.g[1])+(g[10]*h.g[2])+g[14];h.x=n;h.y=j;h.z=i;return h;}}